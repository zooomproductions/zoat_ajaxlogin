var TYPO3FrontendLoginFormRsaEncryptionAjax=function(a){var b=function(b,c){this.form=b,this.xhr=null,this.publicKeyEndpointUrl=c,this.userPasswordField=b.pass,this.handleFormSubmitRequest=function(){var b=this,c=a.ajax(this.publicKeyEndpointUrl).done(function(a){b.handlePublicKeyResponse(a,b)});return c},this.handlePublicKeyResponse=function(a,b){var c=a.split(":");c[0]&&c[1]?b.encryptPassword(c[0],c[1]):alert("No public key could be generated. Please inform your TYPO3 administrator to check the OpenSSL settings.")},this.encryptPassword=function(a,b){var c,d;c=new RSAKey,c.setPublic(a,b),d=c.encrypt(this.userPasswordField.value),this.userPasswordField.value="rsa:"+hex2b64(d)}};return this.encrypt=function(c,d){var e=a.Deferred();return c.rsaFrontendLogin||(c.rsaFrontendLogin=new b(c,d)),c.pass.value.match(/^rsa:/)?e.resolve():c.rsaFrontendLogin.handleFormSubmitRequest().done(e.resolve),e.promise()},this}(jQuery);
